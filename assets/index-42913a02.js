(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(e){if(e.ep)return;e.ep=!0;const r=n(e);fetch(e.href,r)}})();const N=t=>{function o(){return new Promise((c,e)=>{fetch(`https://cep.awesomeapi.com.br/json/${t}`).then(r=>r.json()).then(r=>{c(r)}).catch(r=>{e(r)})})}function n(){return new Promise((c,e)=>{fetch(`https://brasilapi.com.br/api/cep/v2/${t}`).then(r=>r.json()).then(r=>{c(r)}).catch(r=>{e(r)})})}return Promise.any([o(),n()]).then(c=>(console.log(c),c)).catch(c=>{throw console.error(c),c})},y=async()=>{const t=document.querySelector(".cart__address");try{const o=document.querySelector(".cep-input").value,n=await N(o);n.code==="invalid"||n.code==="not_found"?t.innerHTML="CEP não encontrado":t.innerHTML=`${n.address} - ${n.district} - ${n.city} - ${n.state}`}catch{t.innerHTML="CEP não encontrado"}},O=document.querySelector(".cep-button");O.addEventListener("click",async()=>{y()});const g=async t=>{if(t)return await(await fetch(`https://api.mercadolibre.com/items/${t}`)).json();throw new Error("ID não informado")},M=async t=>{if(t)return(await(await fetch(`https://api.mercadolibre.com/sites/MLB/search?q=${t}`)).json()).results;throw new Error("Termo de busca não informado")},p=()=>{const t=localStorage.getItem("cartProducts");return t?JSON.parse(t):[]},$=t=>{if(!t)throw new Error("Você deve fornecer um ID");const n=[...p(),t];localStorage.setItem("cartProducts",JSON.stringify(n))},H=t=>{if(!t)throw new Error("Você deve fornecer um ID");const o=[...p()],n=o.indexOf(t);o.splice(n,1),localStorage.setItem("cartProducts",JSON.stringify(o))},C=document.querySelector(".total-price"),h=[];let f=0;const P=t=>{f+=t,C.innerHTML=f.toFixed(2)},l=t=>{const o=document.createElement("img");return o.className="product__image",o.src=t.replace("I.jpg","O.jpg"),o},a=(t,o,n="")=>{const c=document.createElement(t);return c.className=o,c.innerText=n,c},x=(t,o,n)=>{P(-n),t.remove(),H(o)},v=({id:t,title:o,price:n,pictures:c})=>{const e=document.createElement("li");e.className="cart__product";const r=a("div","cart__product__image-container");h.push(n),P(n);const i=(()=>h.reduce((T,q)=>T+q,0))();C.innerHTML=i;const b=l(c[0].url);r.appendChild(b);const I=l((c[1]||c[0]).url);r.appendChild(I),e.appendChild(r);const u=a("div","cart__product__info-container");u.appendChild(a("span","product__title",o));const m=a("span","product__price","R$ ");m.appendChild(a("span","product__price__value",n)),u.appendChild(m),e.appendChild(u);const S=a("i","material-icons cart__product__remove","delete");return e.appendChild(S),e.addEventListener("click",()=>{x(e,t,n)}),e},j=({id:t,title:o,thumbnail:n,price:c})=>{const e=document.createElement("section");e.className="product",e.appendChild(a("span","product__id",t));const r=a("div","img__container");r.appendChild(l(n)),e.appendChild(r),e.appendChild(a("span","product__title",o));const s=a("span","product__price","R$ ");s.appendChild(a("span","product__price__value",c)),e.appendChild(s);const i=a("button","product__add","Adicionar ao carrinho!");return e.appendChild(i),e};const d=document.querySelector(".products"),E=document.querySelector("h2.loading"),w=document.querySelector(".cart__products"),L=async(t="computador")=>{try{const o=await M(t);E.remove(),o.forEach(n=>{d.appendChild(j(n))}),A()}catch(o){d.innerHTML="Algum erro ocorreu, recarregue a página e tente novamente",d.classList.add("error"),console.log(o)}},A=async()=>{(await document.querySelectorAll(".product__add")).forEach(o=>{o.addEventListener("click",async()=>{const n=o.parentNode.querySelector(".product__id").innerHTML;$(n);const c=await g(n),e=v(c);w.appendChild(e)})})};L();const D=async()=>{p().forEach(o=>{(async()=>{const c=await g(o),e=v(c);w.appendChild(e)})()})};D();const _=document.getElementById("input");_.addEventListener("keydown",async t=>{if(t.key==="Enter"){const o=_.value;d.innerHTML="",E.style.display="block",L(o)}});document.querySelector(".cep-button").addEventListener("click",y);
